OK_FORMAT = True

test = {   'name': 'q4',
    'points': None,
    'suites': [   {   'cases': [   {   'code': '>>> def test_ddpm_unconditional():\n'
                                               '...   test_device = torch.device("cpu")\n'
                                               '...   torch.manual_seed(0)\n'
                                               '...   torch.cuda.manual_seed_all(0)\n'
                                               '...   torch.backends.cudnn.deterministic = True\n'
                                               '...   torch.backends.cudnn.benchmark = False\n'
                                               '...   ddpm_test = DDPM(Unet(in_channels=1, n_feat=128), betas=(1e-4, 0.02), n_T=5, device=test_device)\n'
                                               '...   ddpm_test = ddpm_test.to(test_device)\n'
                                               '...   x_test = torch.rand((4, 1, 28, 28))\n'
                                               '...   x_test = x_test.to(test_device)\n'
                                               '...   ddpm_forward_output = ddpm_test.forward(x_test)\n'
                                               '...   assert torch.isclose(ddpm_forward_output, torch.tensor(1.1693).to(test_device), rtol=0.001)\n'
                                               '...   ddpm_sample_gt0 = torch.tensor([[[[ 8.0431e-01, -7.9461e-01,  1.1468e+00,  2.8695e-01, -5.8212e-01,\n'
                                               '...             6.5696e-01,  9.1232e-01, -8.5409e-02,  6.0503e-01, -1.5679e+00,\n'
                                               '...             2.3135e+00, -9.0685e-01,  6.6370e-01,  3.6106e-01,  1.2108e+00,\n'
                                               '...             2.1367e+00, -6.3883e-01,  8.0043e-01, -3.4062e-01, -1.6515e-01,\n'
                                               '...             3.4380e-02, -2.3264e-01, -3.0703e-02, -1.4744e+00,  1.7353e-01,\n'
                                               '...             1.7094e+00,  7.5477e-01,  5.9471e-01],\n'
                                               '...           [ 2.8478e-01,  8.6225e-01, -4.1034e-01,  3.5214e-01,  1.1347e+00,\n'
                                               '...            -2.2802e-01, -2.3503e+00, -1.2435e+00, -1.1678e+00,  2.3611e-01,\n'
                                               '...            -5.8553e-02, -4.8815e-01, -8.7091e-01, -1.2001e+00, -1.2897e+00,\n'
                                               '...             1.8321e-01, -1.1474e+00,  5.1649e-01, -1.1272e+00,  2.1428e+00,\n'
                                               '...            -3.1893e-01, -2.4233e-01,  1.2550e-01,  3.0801e-01,  1.2842e+00,\n'
                                               '...            -7.5370e-01,  9.1687e-02, -6.3311e-01],\n'
                                               '...           [ 9.1654e-01,  5.9064e-01,  7.3451e-01, -9.5358e-01,  1.9450e-01,\n'
                                               '...            -1.2057e+00,  7.1490e-02, -3.4425e-01, -1.5811e+00,  1.5800e+00,\n'
                                               '...             2.4112e-01,  2.0284e+00, -1.2591e+00,  4.8840e-01, -2.3474e-01,\n'
                                               '...            -9.8252e-01,  1.3077e+00,  6.0516e-01,  2.3894e+00,  4.6598e-01,\n'
                                               '...            -4.4804e-01, -1.3821e-01, -1.4974e-01,  3.4720e-01, -6.3738e-01,\n'
                                               '...             6.1302e-01, -3.6126e-02, -4.6106e-01],\n'
                                               '...           [ 1.1673e+00,  6.5636e-01, -7.7284e-01,  5.4975e-01, -6.0997e-01,\n'
                                               '...            -9.6216e-01,  8.1625e-01, -3.9598e-01, -8.8600e-02, -7.1104e-01,\n'
                                               '...            -3.2824e-01, -8.2823e-01, -1.4946e+00,  1.6935e-01, -1.2885e+00,\n'
                                               '...             1.3116e+00,  1.6397e+00,  5.5766e-01, -3.6806e-01,  2.1696e-01,\n'
                                               '...             8.8411e-01, -1.1553e+00,  7.1921e-01, -4.4355e-02,  1.6173e+00,\n'
                                               '...             4.0081e-01, -8.3012e-02, -7.1287e-01],\n'
                                               '...           [ 2.9218e-01,  6.7029e-01,  7.9905e-01, -7.6451e-01, -9.6771e-01,\n'
                                               '...             2.7867e-01,  1.0657e+00,  3.2473e-01,  2.6701e-01, -4.4500e-01,\n'
                                               '...            -1.0293e+00, -1.3050e+00, -1.3690e-01,  5.5788e-01,  8.4909e-02,\n'
                                               '...             4.3536e-01,  5.6081e-01,  6.0708e-02, -1.6445e+00,  6.3481e-01,\n'
                                               '...             4.8276e-01, -2.4905e+00, -3.7695e-01, -9.5730e-01, -2.2048e+00,\n'
                                               '...            -1.4938e+00,  1.2082e-02,  8.2597e-01],\n'
                                               '...           [ 6.7297e-02, -5.7184e-01, -1.7519e-01, -5.0178e-01,  4.0644e-01,\n'
                                               '...            -1.1583e+00, -8.3660e-01,  6.2089e-01,  2.2996e-01, -6.6834e-01,\n'
                                               '...            -1.4347e-01, -4.8679e-01, -1.7125e+00, -4.1802e-01,  1.3307e+00,\n'
                                               '...             7.5684e-01,  6.9375e-01,  8.8678e-01, -6.3331e-01, -1.4562e+00,\n'
                                               '...             1.2775e-01, -1.7955e+00, -1.5108e-01, -8.2267e-01,  2.5236e+00,\n'
                                               '...            -5.9545e-02,  5.2071e-01,  9.3177e-02],\n'
                                               '...           [ 5.3989e-01,  2.3736e-01,  1.3812e-01, -8.8566e-01, -1.7243e+00,\n'
                                               '...            -3.9779e-01, -4.2466e-01, -5.2142e-01,  1.5854e+00, -2.0105e+00,\n'
                                               '...            -4.4319e-01,  1.9331e-01, -2.0705e+00, -1.4474e-01, -4.9406e-01,\n'
                                               '...            -1.7538e+00, -4.9849e-01,  1.7770e+00,  1.3531e+00, -5.0590e-02,\n'
                                               '...             1.0451e+00,  9.4879e-01, -1.0581e+00,  2.2567e+00,  9.3938e-01,\n'
                                               '...            -5.3342e-01, -5.9448e-01, -8.1167e-01],\n'
                                               '...           [-1.1749e-01,  1.8543e-01,  2.4943e-01,  1.7025e+00,  4.9114e-01,\n'
                                               '...            -6.5352e-02, -1.0180e+00, -1.4654e+00,  1.1878e+00, -1.1955e+00,\n'
                                               '...             4.2817e-01,  1.3060e-01, -1.0065e+00, -1.0396e-01, -3.6938e-01,\n'
                                               '...            -1.3775e+00, -8.3987e-01, -4.1357e-01, -1.3419e+00, -8.1447e-01,\n'
                                               '...            -2.7934e-01, -1.1625e+00,  1.2974e+00,  1.1115e+00,  8.7355e-03,\n'
                                               '...            -9.0486e-01, -8.3102e-01,  1.3339e+00],\n'
                                               '...           [ 4.3789e-02,  2.4528e-01,  1.0106e+00, -6.0224e-01,  1.2948e-01,\n'
                                               '...            -2.3359e-01,  6.1457e-01, -3.7024e-01,  2.3098e-01, -5.7991e-01,\n'
                                               '...             4.9260e-01, -2.2200e-01, -3.4935e-01,  1.5085e+00, -3.3713e-01,\n'
                                               '...            -1.6252e+00,  8.3208e-01, -1.6163e+00,  4.9410e-01,  3.8269e-01,\n'
                                               '...             6.2136e-01, -3.5772e-01,  3.4756e-01, -4.8400e-01,  8.4288e-01,\n'
                                               '...            -8.4637e-01, -2.6067e-01,  1.1476e+00],\n'
                                               '...           [-2.1961e+00,  5.6478e-01, -8.0433e-01,  6.7707e-01,  1.1844e+00,\n'
                                               '...            -3.8037e-01, -1.6661e-01,  1.6920e+00,  9.0443e-01, -2.4285e-01,\n'
                                               '...            -7.9425e-01, -8.2419e-01,  4.4743e-01,  3.0502e-02, -5.6053e-01,\n'
                                               '...             5.0632e-01, -7.0288e-01,  5.7007e-01,  7.3589e-01,  1.0355e+00,\n'
                                               '...            -1.0703e+00,  6.5096e-01, -1.7471e+00,  2.3397e+00,  2.5689e-01,\n'
                                               '...            -9.0769e-01, -2.4279e-01, -1.0093e+00],\n'
                                               '...           [ 1.2681e+00, -8.7378e-01, -3.5869e-01,  1.2744e-01,  5.5776e-01,\n'
                                               '...             6.4647e-01,  1.1470e+00,  2.1085e-01,  1.0334e+00, -8.7115e-01,\n'
                                               '...            -9.9434e-02,  4.1044e-01,  2.8856e-01,  1.0443e+00, -2.0127e+00,\n'
                                               '...            -1.4391e+00,  1.9879e-01, -4.9555e-01, -1.0170e+00,  7.9576e-01,\n'
                                               '...            -4.1284e-01,  8.6842e-01, -7.9652e-01,  2.2621e-01, -1.1809e+00,\n'
                                               '...             1.5315e+00,  2.8580e+00,  2.9972e-01],\n'
                                               '...           [ 2.1777e-01, -1.2738e+00, -1.7863e+00, -6.3172e-01,  8.7812e-01,\n'
                                               '...             2.2839e-01,  5.4645e-01, -1.2199e+00, -4.9416e-01, -7.3085e-01,\n'
                                               '...             2.0392e+00,  6.2892e-01,  5.3632e-01, -8.3807e-01, -1.5298e+00,\n'
                                               '...             1.5018e+00, -9.5986e-01,  2.0601e+00,  4.1184e-01, -4.0940e-01,\n'
                                               '...            -1.6462e+00, -5.7580e-01,  2.3101e-01, -4.8528e-01, -1.4810e+00,\n'
                                               '...             1.2663e+00, -5.7927e-01, -1.3889e-01],\n'
                                               '...           [-1.5136e+00,  1.1596e+00, -5.5714e-02,  1.4668e-01, -1.2656e+00,\n'
                                               '...             2.8775e-01,  9.6107e-01,  8.8660e-01,  4.4072e-01, -7.7936e-02,\n'
                                               '...             1.7143e-01, -9.2794e-01, -9.1475e-01,  3.2217e-01, -9.1122e-01,\n'
                                               '...            -5.7523e-01,  8.9012e-01,  3.0214e-01, -6.5376e-01,  6.1503e-01,\n'
                                               '...             1.5732e+00, -2.4188e-01, -1.4145e+00, -3.3914e-01, -2.0857e+00,\n'
                                               '...            -5.7919e-01,  1.4184e+00,  1.4708e-01],\n'
                                               '...           [ 5.9968e-01, -6.2249e-01,  4.7390e-01,  1.4226e-01,  3.5039e-01,\n'
                                               '...            -1.1615e+00,  7.4143e-01, -1.1397e+00, -1.5988e-01,  1.3869e+00,\n'
                                               '...             2.5917e-01, -4.9569e-01,  1.7680e+00,  5.8312e-02, -1.6574e-01,\n'
                                               '...             4.0906e-01,  4.6553e-02, -1.7268e+00, -1.1338e+00, -1.7236e+00,\n'
                                               '...             9.5003e-01,  9.3256e-01, -3.0154e-01, -6.0513e-02,  5.9518e-01,\n'
                                               '...             1.2695e+00,  1.0983e-01, -1.5478e+00],\n'
                                               '...           [ 9.3309e-01,  5.4874e-01, -2.4077e-01, -3.0544e-01,  5.2009e-02,\n'
                                               '...            -6.9715e-01, -4.7613e-01, -3.2849e-02, -1.1768e+00,  1.0897e+00,\n'
                                               '...             4.6360e-01,  6.8561e-01,  3.8567e-01, -1.9617e-01, -1.1829e+00,\n'
                                               '...            -3.2985e-01,  1.2157e+00, -7.2893e-01, -1.2178e-01, -1.1347e-01,\n'
                                               '...             1.3270e+00,  9.0829e-01, -1.3033e-01, -3.5960e-01, -1.7605e+00,\n'
                                               '...             7.0151e-01,  2.9121e-01,  6.1501e-01],\n'
                                               '...           [ 4.6262e-01, -1.6325e+00, -1.8707e-01, -9.4192e-01, -1.4024e-01,\n'
                                               '...            -4.3511e-01, -1.1634e+00,  4.4501e-01, -7.0515e-01, -2.2045e+00,\n'
                                               '...            -2.7666e+00, -1.4737e+00, -4.6260e-01,  4.7618e-01, -5.4910e-02,\n'
                                               '...            -4.3202e-01, -1.9049e+00, -1.0350e+00, -2.2580e+00,  5.5107e-01,\n'
                                               '...             1.7970e+00,  1.1145e+00, -1.0998e+00,  3.1097e+00, -7.4719e-01,\n'
                                               '...            -7.5196e-01,  3.2825e-01,  2.7869e-01],\n'
                                               '...           [ 4.0541e-01, -2.8468e-01,  6.9525e-01, -3.3173e-03, -7.4790e-01,\n'
                                               '...             2.0887e+00,  1.7383e+00,  1.0470e+00, -3.2943e-01, -8.3102e-02,\n'
                                               '...             3.6376e-01,  1.0572e-01,  2.8291e-01, -5.3773e-01, -4.0824e-01,\n'
                                               '...            -8.9676e-02,  2.0648e+00,  7.7867e-01, -8.9695e-01,  2.8457e-01,\n'
                                               '...             9.9186e-01,  3.0568e-01,  4.9463e-01,  4.8188e-01, -2.1956e+00,\n'
                                               '...            -6.2505e-01, -4.7462e-01, -1.9387e+00],\n'
                                               '...           [-1.7757e+00,  7.2912e-01,  2.5116e-01, -1.6785e+00,  1.1331e+00,\n'
                                               '...            -1.0359e+00, -1.4109e+00, -2.6162e+00, -6.0652e-01, -1.1794e+00,\n'
                                               '...            -1.2100e+00, -1.1742e+00,  1.9593e+00,  4.5560e-02, -2.6619e+00,\n'
                                               '...            -3.6641e-02,  5.6514e-01,  1.0004e-01, -3.4455e-01, -2.4721e+00,\n'
                                               '...             1.3739e+00, -4.7730e-01,  1.4798e+00,  4.0847e-01, -4.2393e-01,\n'
                                               '...             9.9892e-01, -5.6715e-01,  9.3204e-01],\n'
                                               '...           [-1.6619e-01,  1.4603e+00,  1.3167e+00,  1.0197e+00, -2.0308e-01,\n'
                                               '...             2.1049e+00,  5.2528e-01,  1.6940e+00,  1.6925e-01, -1.9653e-01,\n'
                                               '...             3.0277e-01,  1.4640e+00,  3.6053e-01, -9.5820e-01,  2.5261e-01,\n'
                                               '...            -1.7474e-01,  1.1419e-01, -5.0850e-01, -2.7773e-01,  7.3327e-01,\n'
                                               '...             1.6828e+00,  2.7127e-02,  8.7163e-01, -6.3273e-01,  6.0004e-01,\n'
                                               '...            -2.5927e-01, -4.7601e-01, -1.0879e-01],\n'
                                               '...           [-8.6637e-01,  5.9656e-01,  6.4879e-01,  1.5459e-01, -3.5025e-01,\n'
                                               '...            -1.2372e+00, -1.6176e+00, -6.9153e-01, -6.5666e-01, -2.0809e+00,\n'
                                               '...            -6.6442e-01, -2.6473e-01,  2.8299e-01,  2.3259e-01, -1.9105e-01,\n'
                                               '...             6.5199e-01, -4.0545e-01, -7.1470e-01, -1.7221e+00,  4.5686e-02,\n'
                                               '...             1.1933e+00, -6.3700e-01,  1.0198e+00,  1.3234e+00, -1.2244e+00,\n'
                                               '...            -1.6157e-01, -8.8994e-01, -1.7682e+00],\n'
                                               '...           [-6.0513e-01,  1.6994e+00, -1.5461e+00,  9.7786e-01,  1.1270e-02,\n'
                                               '...            -2.9409e-01, -4.3109e-01,  6.0735e-01,  8.5686e-02,  1.0103e+00,\n'
                                               '...             1.1627e+00,  5.6352e-01, -1.3061e+00, -4.0265e-01, -1.0127e+00,\n'
                                               '...            -7.1604e-01, -1.6396e+00,  8.0147e-01, -1.2801e+00,  1.6311e-01,\n'
                                               '...             1.3081e-01, -6.9881e-01, -1.2874e-01, -9.0898e-01, -7.8386e-01,\n'
                                               '...            -2.4797e-01,  1.2159e+00,  1.0526e+00],\n'
                                               '...           [ 9.2934e-01,  2.4580e+00, -8.5842e-01,  2.4756e-02,  8.9540e-01,\n'
                                               '...            -2.7165e-01,  3.6711e-01, -1.2839e+00,  1.1603e+00, -6.6294e-01,\n'
                                               '...             5.0203e-01,  1.0359e+00, -2.4640e+00,  1.1214e-01, -3.9152e-01,\n'
                                               '...             2.7899e-01, -4.6739e-01,  1.4358e-01,  2.2796e-01,  1.3375e+00,\n'
                                               '...             5.0980e-01, -2.5379e+00, -1.5210e+00, -7.7799e-01,  1.3245e+00,\n'
                                               '...             1.7689e+00, -1.6832e+00,  6.2038e-01],\n'
                                               '...           [-1.1570e+00, -8.5962e-01,  4.0296e-02,  1.1641e+00, -1.0153e+00,\n'
                                               '...            -2.0319e-01,  6.0555e-01,  8.1019e-01,  3.4439e-01, -1.4958e+00,\n'
                                               '...            -1.0899e+00,  1.2997e+00,  1.6059e-01, -2.4905e-02, -3.7700e-01,\n'
                                               '...             2.0388e-01, -9.1587e-01,  3.5990e-01, -1.4913e+00,  1.1889e+00,\n'
                                               '...             8.8758e-01,  9.4518e-01, -2.0560e+00, -8.4086e-01,  4.8848e-01,\n'
                                               '...            -2.1436e+00, -1.0944e+00,  3.4496e-01],\n'
                                               '...           [ 1.4216e+00, -7.8534e-01, -3.8964e-01,  2.8538e-01,  1.2750e+00,\n'
                                               '...            -3.2001e-01,  1.0099e+00, -2.3591e-01, -1.3908e+00, -5.9205e-02,\n'
                                               '...            -7.9485e-01, -8.4666e-01,  1.8133e+00,  3.0746e-01, -1.3511e+00,\n'
                                               '...             7.7121e-01,  5.0538e-01, -9.4741e-01,  7.2847e-01,  8.1619e-01,\n'
                                               '...            -2.1859e-01, -4.5992e-01, -1.2082e+00,  7.5831e-01,  1.6869e+00,\n'
                                               '...             9.7532e-01,  9.5041e-01, -3.2275e-01],\n'
                                               '...           [-9.9657e-01,  5.6302e-01, -9.1182e-01,  7.3841e-01, -1.7009e+00,\n'
                                               '...             1.3514e-01,  1.0981e+00,  5.3078e-01, -1.0337e+00,  1.0075e-01,\n'
                                               '...             1.2703e+00,  1.7345e+00,  8.9975e-01,  2.1856e+00, -1.1166e+00,\n'
                                               '...            -1.2199e-01, -1.6443e+00, -1.7506e+00,  1.7867e-01,  1.1562e+00,\n'
                                               '...            -3.5816e-01, -8.7441e-01, -8.2018e-01,  5.5052e-01, -1.1254e+00,\n'
                                               '...             4.6000e-01, -1.1486e+00, -1.8410e+00],\n'
                                               '...           [ 7.4762e-01,  9.5600e-01, -1.0981e+00,  4.0444e-01, -7.3594e-02,\n'
                                               '...            -2.3527e-01,  3.1102e-01, -7.3798e-02, -3.7691e-01,  1.6563e+00,\n'
                                               '...             7.0202e-01,  4.2893e-01, -1.9892e-01, -2.2648e+00,  1.5311e-01,\n'
                                               '...            -7.4098e-01, -1.2220e+00, -1.7702e+00,  1.9662e-01, -1.6867e-01,\n'
                                               '...             3.7750e-01,  5.1861e-01, -7.8595e-01,  8.6500e-01, -5.2520e-01,\n'
                                               '...            -5.4400e-01, -9.8885e-01, -1.6105e+00],\n'
                                               '...           [ 2.7675e+00,  1.2666e+00, -1.7840e+00,  1.0887e+00,  5.2850e-01,\n'
                                               '...             3.2689e-01, -1.1800e+00,  9.5112e-01,  1.9052e+00, -7.7286e-01,\n'
                                               '...            -1.8043e-01,  5.9059e-01, -1.0738e+00, -3.8688e-01, -7.6694e-01,\n'
                                               '...             1.6044e+00, -3.7262e-01,  3.6687e-01,  1.3514e+00,  1.2703e+00,\n'
                                               '...             2.4593e+00,  1.3299e+00,  2.1765e-01,  8.3641e-01,  1.2468e+00,\n'
                                               '...             1.9593e-01,  1.3501e+00,  4.6606e-01],\n'
                                               '...           [-5.1603e-01, -6.7072e-01, -8.6662e-01,  1.5341e+00, -1.9173e+00,\n'
                                               '...            -1.3416e+00, -4.3839e-01, -2.3282e-01, -7.8265e-01, -4.3664e-01,\n'
                                               '...             2.4559e-02, -1.2882e-01,  1.6481e-01,  9.3152e-01, -2.1058e+00,\n'
                                               '...            -5.3540e-01, -1.0613e+00, -3.3288e-01, -1.0061e+00, -2.1012e+00,\n'
                                               '...             7.4471e-01, -6.8331e-01, -3.3071e-01,  1.6720e+00,  9.7085e-01,\n'
                                               '...            -3.4019e-01,  1.4721e-01, -1.4631e+00]]],\n'
                                               '...         [[[-1.8546e+00, -4.3127e-01, -1.0497e-01, -1.3856e+00,  5.5363e-01,\n'
                                               '...             3.4181e-01,  5.2992e-01,  7.8026e-01,  9.6986e-01, -1.7681e+00,\n'
                                               '...            -1.3887e+00, -9.1103e-01,  2.5841e-01,  9.3938e-01,  9.5283e-01,\n'
                                               '...             6.5296e-01, -9.2445e-01,  5.6296e-01, -6.4109e-01, -3.2585e-01,\n'
                                               '...             1.3538e+00,  1.7570e-01,  4.3889e-01, -1.0610e+00, -2.7716e-01,\n'
                                               '...             1.6335e-01, -1.2037e-01,  5.5283e-01],\n'
                                               '...           [-1.0791e+00,  7.2032e-01,  2.0770e-01,  2.0780e-02, -1.6068e+00,\n'
                                               '...             4.0508e-01, -9.7419e-01, -1.4080e+00,  8.9151e-01, -5.2570e-01,\n'
                                               '...             1.4152e+00,  1.1610e+00, -9.1876e-02, -1.0303e+00,  4.4495e-01,\n'
                                               '...             1.5846e-01,  1.4732e-01, -1.0261e+00,  9.7570e-02, -4.5948e-01,\n'
                                               '...            -7.1716e-01, -2.7281e+00,  9.9726e-01, -4.5103e-01, -1.0594e+00,\n'
                                               '...             2.0246e-01, -2.5877e-01, -1.6869e+00],\n'
                                               '...           [-2.6667e-01,  1.0107e+00,  1.3866e-01, -4.0688e-02,  1.5420e+00,\n'
                                               '...            -2.0702e+00,  1.9164e-01, -9.0843e-01, -6.9644e-02,  7.2859e-01,\n'
                                               '...            -3.9250e-01,  5.0625e-01, -1.9400e+00, -5.8852e-01, -1.0775e+00,\n'
                                               '...             1.8680e-01,  7.8342e-01, -1.4419e-01,  1.8135e-01, -7.8112e-01,\n'
                                               '...             1.4599e-01,  1.5570e+00, -4.5966e-01,  2.2316e+00, -3.0357e-01,\n'
                                               '...            -2.8952e-02,  9.1130e-01, -1.3889e+00],\n'
                                               '...           [ 7.9543e-01, -1.0860e+00, -4.8739e-01,  9.7451e-02, -1.3168e+00,\n'
                                               '...             2.0715e-02,  8.5455e-02,  1.8185e-01,  1.2369e+00,  2.2949e+00,\n'
                                               '...             3.7156e-01,  1.3779e+00, -1.8590e+00,  1.3753e+00, -1.5687e+00,\n'
                                               '...            -8.6662e-01,  1.1546e+00, -1.4518e+00, -9.4952e-01, -2.4872e+00,\n'
                                               '...             1.9159e+00, -2.7001e+00, -3.0330e-01, -1.2762e+00,  6.8839e-01,\n'
                                               '...            -7.0032e-01, -7.6019e-01,  1.3614e+00],\n'
                                               '...           [ 1.9980e+00,  1.2118e+00, -5.8280e-02,  1.1728e+00, -8.9034e-01,\n'
                                               '...            -7.4754e-01,  4.5337e-02, -1.3241e+00, -2.4206e-01,  6.8428e-01,\n'
                                               '...            -1.3778e+00,  2.7233e-01,  9.5267e-01, -4.4249e-02,  5.4374e-01,\n'
                                               '...             3.3545e-02, -2.2992e-02,  6.1034e-03, -9.8933e-01, -1.1841e+00,\n'
                                               '...            -2.1237e-01,  1.2902e+00, -3.3268e-01, -1.3026e+00, -9.5991e-01,\n'
                                               '...            -2.2905e+00, -1.1380e+00, -2.8675e+00],\n'
                                               '...           [ 1.7828e+00,  2.5089e+00,  5.0736e-01,  3.8564e-01,  6.7468e-01,\n'
                                               '...            -6.4703e-02,  9.6533e-01,  2.0545e-01,  1.5340e+00,  1.8637e+00,\n'
                                               '...             9.0157e-03,  1.0337e+00,  5.1367e-02, -1.3173e+00, -1.0436e+00,\n'
                                               '...            -1.7678e+00,  6.7078e-01, -1.5583e+00, -1.5847e+00,  1.1582e+00,\n'
                                               '...            -5.1106e-01,  5.7118e-01, -1.7336e+00,  1.2680e+00, -9.9303e-03,\n'
                                               '...            -1.5230e+00,  8.0542e-01, -7.1604e-01],\n'
                                               '...           [ 5.1104e-01, -1.6863e-01, -7.2624e-01,  3.9243e-01,  2.3642e+00,\n'
                                               '...            -4.8150e-01, -1.8239e+00, -1.8064e+00, -2.4549e-01,  1.7244e+00,\n'
                                               '...            -8.8857e-01, -7.6350e-01,  5.7967e-01,  1.6109e-01,  1.1327e+00,\n'
                                               '...             1.0769e+00, -8.1860e-02, -8.5828e-01,  5.8978e-01,  1.0944e+00,\n'
                                               '...            -1.4337e+00,  3.1794e-01, -4.5686e-01, -2.3286e-01,  1.4740e-01,\n'
                                               '...            -4.1168e-01,  5.6219e-01,  1.3119e-01],\n'
                                               '...           [-5.7297e-01, -7.9717e-02, -5.8669e-01, -2.7121e-01,  3.5789e-01,\n'
                                               '...             6.8163e-01, -1.2924e+00, -3.4825e-01, -6.2947e-01,  6.7096e-01,\n'
                                               '...             5.2556e-01,  2.2041e+00, -1.4280e-01, -7.9598e-01,  1.3324e+00,\n'
                                               '...            -9.6382e-01, -2.4336e-01, -1.3729e-01,  1.2174e+00, -5.7112e-01,\n'
                                               '...             7.4082e-01,  6.4775e-01,  3.6785e-01, -1.5274e+00, -1.4160e+00,\n'
                                               '...             1.4258e-01,  1.5245e+00,  9.6932e-01],\n'
                                               '...           [-5.3589e-01,  2.8116e-01,  7.2002e-01, -5.8855e-01, -8.9739e-01,\n'
                                               '...            -1.0817e-01, -5.4385e-01,  6.6034e-01, -1.0075e+00, -6.5004e-01,\n'
                                               '...            -1.4189e-01,  1.4460e+00,  1.4896e+00,  1.1828e+00,  2.1561e+00,\n'
                                               '...             1.1486e+00, -1.2172e+00, -6.0609e-01,  1.2589e+00,  7.9265e-01,\n'
                                               '...             2.6542e-01, -9.7524e-02,  1.0561e+00, -1.2906e+00, -3.4049e-01,\n'
                                               '...            -1.4657e+00, -2.1723e-01, -4.2928e-01],\n'
                                               '...           [ 5.5478e-01,  1.4357e+00, -7.8980e-01,  6.7576e-02,  3.0477e-01,\n'
                                               '...            -4.3723e-01,  1.6855e+00, -3.1951e-01,  6.8473e-01,  4.6904e-01,\n'
                                               '...             1.5276e+00,  2.0652e+00,  4.4031e-02, -3.4834e-01,  1.2619e-02,\n'
                                               '...            -2.2247e+00, -1.1693e+00,  7.2751e-01, -1.7950e-01,  1.2052e+00,\n'
                                               '...            -2.0272e+00, -4.1694e-01, -2.8972e+00,  2.1377e-01, -8.2634e-01,\n'
                                               '...             1.9452e-01,  1.4590e+00, -9.8888e-01],\n'
                                               '...           [-8.6858e-01, -1.5805e+00,  5.3420e-01, -2.2335e+00, -7.8719e-02,\n'
                                               '...             7.3039e-01, -3.6307e-01, -8.6204e-01, -7.8312e-01, -5.2666e-01,\n'
                                               '...            -1.2583e+00, -3.2079e-01,  1.6908e-01,  1.2126e+00,  4.8031e-01,\n'
                                               '...             1.1412e-01,  1.4388e+00, -1.2071e+00, -2.2386e+00,  8.4475e-01,\n'
                                               '...            -1.3682e-01, -1.9463e+00, -1.8401e+00, -4.3369e-01,  1.1773e+00,\n'
                                               '...            -2.4473e-01,  6.6518e-01, -1.5534e+00],\n'
                                               '...           [ 1.0740e+00, -1.6133e+00,  8.9488e-01, -8.5943e-01,  3.7214e-01,\n'
                                               '...             5.4096e-01,  4.2504e-01, -5.2753e-01, -1.0120e-01, -1.8852e+00,\n'
                                               '...            -4.3337e-01, -1.4632e+00,  4.0817e-01, -3.3957e-01,  4.3069e-01,\n'
                                               '...            -6.0892e-01,  1.2957e+00,  5.5183e-01, -2.3709e-01,  1.3478e+00,\n'
                                               '...             2.7897e-01, -1.1749e+00,  1.1564e-01, -8.0311e-01, -1.6814e-01,\n'
                                               '...            -1.0480e+00, -4.5895e-01, -7.1839e-01],\n'
                                               '...           [-2.3641e-01, -1.0011e+00, -7.5605e-01, -2.1481e-01, -1.2066e+00,\n'
                                               '...             6.0611e-01, -1.4967e+00, -1.5371e+00,  1.3578e-01,  8.7157e-02,\n'
                                               '...            -6.0286e-01, -6.1773e-01,  7.6290e-01, -2.8332e-01, -1.3165e+00,\n'
                                               '...            -1.8214e+00, -4.8831e-01, -1.2070e+00, -1.2039e+00, -7.8575e-01,\n'
                                               '...             1.2797e+00,  8.0536e-01, -2.6329e+00, -3.0616e-01, -1.5428e+00,\n'
                                               '...             9.3565e-01,  1.1556e+00,  4.3854e-01],\n'
                                               '...           [-6.2327e-02, -1.6018e+00, -1.5386e+00, -1.2059e-02,  4.7577e-01,\n'
                                               '...            -3.6992e-01,  8.8602e-02, -3.8842e-01,  1.6069e+00, -2.2259e+00,\n'
                                               '...            -1.5768e+00,  1.1820e+00,  8.9355e-01, -2.8353e-01, -3.9062e-01,\n'
                                               '...             8.7550e-01, -4.8365e-01,  5.3857e-01, -8.0950e-01,  1.6968e+00,\n'
                                               '...            -8.8724e-01, -1.3274e-01, -4.1329e-01,  1.1868e+00, -2.4402e-01,\n'
                                               '...            -3.6816e-01,  1.2068e+00, -1.3040e+00],\n'
                                               '...           [ 2.1701e+00,  9.7161e-02,  3.3032e-01,  1.5567e-01,  1.2267e+00,\n'
                                               '...             4.3418e-01, -4.8976e-01, -2.5438e-01,  1.0843e+00,  8.0773e-01,\n'
                                               '...            -2.3135e+00, -5.9878e-01,  1.8138e+00,  1.0221e+00, -2.0994e+00,\n'
                                               '...             5.5887e-01,  7.1335e-01, -8.8089e-01, -1.4424e+00, -7.7643e-01,\n'
                                               '...             9.3888e-01, -1.7788e+00,  1.4149e-01, -1.5864e+00, -5.4212e-01,\n'
                                               '...             1.2531e+00,  2.6679e-02,  3.8624e-01],\n'
                                               '...           [-1.1270e+00,  1.1046e+00, -2.5238e+00, -2.6287e-01, -2.9113e+00,\n'
                                               '...             9.0644e-01, -2.2296e-01, -6.6256e-01,  7.2659e-01,  4.3164e-01,\n'
                                               '...             2.1590e-01, -6.0519e-01, -5.2317e-01,  6.9009e-01, -7.9230e-01,\n'
                                               '...             1.2012e+00, -3.1123e-01,  1.3268e-01,  8.7971e-02, -1.2707e+00,\n'
                                               '...            -6.1443e-01,  9.0246e-01,  1.0602e+00, -1.6256e+00,  1.4096e+00,\n'
                                               '...            -1.0561e+00,  2.8869e-01, -3.2512e-02],\n'
                                               '...           [-1.2688e+00,  2.2904e+00,  3.5593e-01, -5.4484e-01,  2.2657e+00,\n'
                                               '...            -1.9760e+00, -3.9854e-01,  6.8660e-01,  2.0586e+00, -3.0951e-01,\n'
                                               '...            -9.1264e-01, -1.4568e-01,  2.7270e-01,  1.2783e+00, -1.6010e+00,\n'
                                               '...            -2.5802e+00,  2.1856e+00, -6.7490e-01,  9.7787e-01, -1.8291e-01,\n'
                                               '...            -2.7190e-01,  2.8874e-01, -4.1680e-01,  2.0369e-01, -4.2191e-01,\n'
                                               '...             9.7954e-01,  1.0812e+00, -1.3452e-01],\n'
                                               '...           [ 1.1972e+00, -4.7656e-01, -1.2840e+00,  1.3501e+00,  6.9513e-01,\n'
                                               '...            -2.0576e+00,  7.6554e-01,  4.9343e-01, -2.9246e-01,  5.3910e-01,\n'
                                               '...             1.8978e-01, -8.3273e-01, -2.4210e-01,  1.0499e+00,  9.7304e-01,\n'
                                               '...            -1.9302e+00, -9.9585e-02,  1.2211e+00,  5.2834e-01,  8.8976e-01,\n'
                                               '...             7.7006e-01, -7.3724e-01, -6.9279e-01, -2.8062e-01, -7.5917e-02,\n'
                                               '...            -2.9999e+00,  8.3832e-01, -5.8700e-01],\n'
                                               '...           [-1.1015e+00,  8.9944e-01,  3.4488e-01, -7.6203e-01,  3.6917e-01,\n'
                                               '...            -3.7866e-01, -8.2142e-01, -5.0131e-02,  1.1227e+00,  9.9956e-01,\n'
                                               '...             1.7179e+00,  1.7148e-01, -4.3517e-01,  5.7780e-01, -1.3822e+00,\n'
                                               '...            -3.2519e-01, -3.5349e-01,  2.3007e-01,  9.4394e-01,  1.3078e+00,\n'
                                               '...             1.4560e+00,  1.1534e+00, -1.0762e+00,  1.6329e+00,  8.4160e-01,\n'
                                               '...            -6.6106e-01,  1.8181e+00, -1.6573e-01],\n'
                                               '...           [ 1.6537e+00, -5.2278e-01,  4.3511e-01,  3.8264e-01,  7.5659e-01,\n'
                                               '...             6.3589e-01,  2.0582e-01,  6.3540e-01, -6.6626e-01,  1.1910e+00,\n'
                                               '...            -9.5285e-02, -4.6449e-01,  1.7439e-01,  2.5545e-02, -4.1648e-01,\n'
                                               '...             7.7929e-01, -7.6858e-01,  3.7875e-01, -2.6424e-01,  1.5276e+00,\n'
                                               '...            -1.3128e+00, -4.9861e-01,  1.3850e+00, -3.6675e-01, -1.4879e+00,\n'
                                               '...            -1.9618e+00,  1.5402e+00,  4.4498e-02],\n'
                                               '...           [-7.9196e-01,  2.7990e-01,  3.9443e-01,  8.2194e-02,  6.1749e-01,\n'
                                               '...             5.9277e-02, -5.0448e-01, -1.3065e-01, -1.5773e+00, -8.7749e-01,\n'
                                               '...            -3.8904e-01, -5.1698e-01, -5.0079e-01,  1.5109e+00, -8.0373e-02,\n'
                                               '...             9.2636e-01,  7.5624e-01,  1.0114e+00, -2.2451e-01, -2.0940e-01,\n'
                                               '...             1.2568e-01,  1.5077e+00, -2.8879e+00, -1.0055e-01, -7.9443e-01,\n'
                                               '...            -2.0338e+00, -1.6737e+00, -3.4749e-01],\n'
                                               '...           [ 1.0728e+00, -1.4881e+00, -1.1480e-01,  1.4409e+00, -1.3020e+00,\n'
                                               '...             1.8667e+00, -2.6664e+00, -1.9638e+00, -6.0485e-01, -2.7090e+00,\n'
                                               '...            -2.1014e+00, -2.5417e-01, -1.4635e+00, -9.6499e-01, -2.3868e+00,\n'
                                               '...            -8.9851e-01, -5.3682e-01, -8.2363e-02,  5.6631e-01, -1.0961e+00,\n'
                                               '...             4.8342e-01, -5.8486e-01, -9.9642e-01,  1.6528e+00, -1.0355e+00,\n'
                                               '...            -6.6498e-01, -2.5194e+00,  1.0086e+00],\n'
                                               '...           [ 1.5983e+00, -1.3088e+00, -8.9735e-01, -1.2179e+00,  7.0327e-01,\n'
                                               '...            -7.4951e-01, -6.4065e-01,  1.1514e+00, -2.1790e+00, -3.9624e-01,\n'
                                               '...             5.1760e-01, -8.8686e-01,  3.4337e-01, -5.9034e-01, -5.1316e-01,\n'
                                               '...            -1.0092e+00,  1.8109e+00, -4.6450e-01,  8.4584e-01,  6.9969e-01,\n'
                                               '...             1.3791e+00,  2.8328e-01,  1.6082e+00,  1.1145e-01, -9.1828e-01,\n'
                                               '...            -1.3114e+00,  1.2921e+00,  6.9930e-01],\n'
                                               '...           [-1.8829e-01,  4.9446e-01,  1.4486e+00,  1.2334e+00,  1.2499e+00,\n'
                                               '...             3.3968e-01, -2.7654e-02,  2.5707e-01,  1.4240e+00,  1.7443e+00,\n'
                                               '...            -1.2744e+00, -1.3028e+00, -4.2896e-01, -7.4226e-01,  8.5344e-01,\n'
                                               '...            -4.4039e-01, -1.3816e+00, -6.3035e-01,  9.1521e-01, -7.0278e-01,\n'
                                               '...            -1.7398e-01,  5.1482e-01,  2.1961e-01, -2.9211e-02, -9.2244e-01,\n'
                                               '...            -1.4136e+00,  5.0122e-01,  2.2710e+00],\n'
                                               '...           [ 1.2673e+00,  2.8449e-01, -1.8519e+00,  2.4874e-01, -2.1907e+00,\n'
                                               '...             7.0762e-01, -7.9945e-01, -1.9911e-01,  1.1040e-02, -1.3764e+00,\n'
                                               '...            -2.2413e+00,  4.9476e-01,  8.6230e-02, -5.5553e-04, -4.8719e-01,\n'
                                               '...            -5.5687e-01, -1.3255e+00,  6.8378e-01, -1.2095e+00, -9.0873e-01,\n'
                                               '...             1.5179e+00, -4.7904e-02,  9.2680e-01, -1.2433e+00, -3.0636e-01,\n'
                                               '...             4.5688e-01, -1.9869e+00, -1.5959e+00],\n'
                                               '...           [-1.0026e+00, -6.3831e-01, -6.0203e-01,  1.5976e+00,  5.1500e-01,\n'
                                               '...             6.1135e-01, -1.2855e+00, -2.1932e+00, -7.4557e-01,  3.2113e-01,\n'
                                               '...            -1.3956e+00, -1.1973e+00, -1.3073e-01, -8.5744e-01, -3.1468e-01,\n'
                                               '...            -5.6819e-01,  1.2347e+00,  1.0596e+00, -5.7621e-01, -3.9237e-01,\n'
                                               '...            -1.3458e+00, -6.8464e-01,  1.1195e+00,  3.7229e-02, -8.0281e-01,\n'
                                               '...            -2.3998e+00,  1.3393e+00, -2.2185e-02],\n'
                                               '...           [ 7.1823e-01,  1.6289e+00, -6.2583e-01, -1.2824e+00,  1.5917e+00,\n'
                                               '...            -1.5346e+00,  1.0834e+00,  7.6842e-01, -8.0305e-02, -2.0961e-01,\n'
                                               '...             3.1600e-01,  7.8190e-01,  3.2104e-01, -8.4384e-01,  1.4939e+00,\n'
                                               '...            -2.8245e-01, -1.7364e+00, -1.4453e+00,  9.6988e-01,  7.0945e-01,\n'
                                               '...             8.0586e-01,  1.0929e-01, -2.5201e+00, -8.1064e-02, -1.1026e-01,\n'
                                               '...            -7.4450e-01,  2.1972e-01,  7.6453e-01],\n'
                                               '...           [ 1.0795e+00,  5.9110e-01, -1.7127e+00,  1.9303e+00, -4.6502e-01,\n'
                                               '...            -1.6395e+00, -6.8006e-01,  1.6175e+00, -8.4731e-02,  1.4703e+00,\n'
                                               '...            -1.0729e+00,  7.2293e-01,  5.4459e-01,  3.7685e-01,  4.5190e-01,\n'
                                               '...             7.1088e-01, -9.9444e-01,  2.5099e+00, -2.0868e-01, -7.3502e-01,\n'
                                               '...             5.2570e-01,  7.6356e-01, -4.6933e-01, -2.1719e-01, -1.1502e+00,\n'
                                               '...             1.9804e-01, -6.7830e-01,  2.3292e-01]]]])\n'
                                               '...   ddpm_sample_output0, _ = ddpm_test.sample(2, (1, 28, 28), device=test_device)\n'
                                               '...   assert torch.allclose(ddpm_sample_output0, ddpm_sample_gt0, rtol=0.001)\n'
                                               '>>> test_ddpm_unconditional()\n',
                                       'hidden': False,
                                       'locked': False}],
                      'scored': True,
                      'setup': '',
                      'teardown': '',
                      'type': 'doctest'}]}
