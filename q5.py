OK_FORMAT = True

test = {   'name': 'q5',
    'points': None,
    'suites': [   {   'cases': [   {   'code': '>>> def test_ddpm_conditional():\n'
                                               '...   torch.manual_seed(0)\n'
                                               '...   torch.cuda.manual_seed_all(0)\n'
                                               '...   torch.backends.cudnn.deterministic = True\n'
                                               '...   torch.backends.cudnn.benchmark = False\n'
                                               "...   test_device = torch.device('cpu')\n"
                                               '...   ddpm_c_test = DDPM(nn_model=ContextUnet(1, 128, 10), betas=(1e-4, 0.02), n_T=5, device=test_device, drop_prob=0.1)\n'
                                               '...   ddpm_c_test = ddpm_c_test.to(test_device)\n'
                                               '...   x_test = torch.rand((4, 1, 28, 28))\n'
                                               '...   c_test = torch.randint(0, 10, (4,))\n'
                                               '...   x_test = x_test.to(test_device)\n'
                                               '...   c_test = c_test.to(test_device)\n'
                                               '...   ddpm_c_forward_output = ddpm_c_test.forward(x_test, c_test)\n'
                                               '...   assert torch.isclose(ddpm_c_forward_output, torch.tensor(1.0185).to(test_device), rtol=0.001)\n'
                                               '...   ddpm_c_sample_gt0 = torch.tensor([[[-4.6060e-02,  1.7940e+00,  1.1914e+00,  8.7845e-01, -5.8392e-01,\n'
                                               '...            1.3026e+00, -2.6123e-01, -1.6791e+00, -8.9847e-01,  6.6718e-01,\n'
                                               '...           -1.1336e+00, -8.3759e-02,  1.0781e-01, -6.4724e-02,  1.0162e+00,\n'
                                               '...            6.8887e-01, -6.2289e-02, -9.5861e-01,  1.5583e-01, -1.6906e+00,\n'
                                               '...           -1.4405e+00,  3.3511e-01, -3.8326e-01,  5.8832e-01, -1.1027e+00,\n'
                                               '...            5.2386e-01,  1.9921e+00,  1.2049e+00],\n'
                                               '...          [ 9.2026e-01, -2.1616e+00,  3.6019e-02, -1.0430e+00, -2.9785e-02,\n'
                                               '...            3.2359e+00,  1.2945e+00,  1.3721e+00,  5.7792e-01,  9.1429e-01,\n'
                                               '...           -1.3888e+00, -7.3942e-01, -2.0509e+00,  1.0820e+00,  9.5658e-01,\n'
                                               '...           -1.3796e+00, -3.2095e-03,  4.1555e-02,  1.6172e+00,  1.5030e-01,\n'
                                               '...            1.8439e+00,  2.3623e+00,  2.7408e+00,  1.3711e+00, -1.1867e+00,\n'
                                               '...            2.5224e-01,  1.7090e+00, -1.4246e-02],\n'
                                               '...          [ 1.7647e+00, -8.7406e-01, -5.9643e-01, -2.5159e-01, -1.6777e-01,\n'
                                               '...            2.2148e-01, -1.4146e+00,  2.6250e+00, -1.2857e+00, -5.4391e-01,\n'
                                               '...           -7.9223e-01, -1.9606e+00,  6.4259e-01, -1.5426e+00, -1.6459e+00,\n'
                                               '...            1.2836e+00,  8.0961e-01,  1.8565e+00, -1.7249e-01,  4.9073e-01,\n'
                                               '...           -1.1635e-03,  8.2025e-01,  4.8961e-01, -1.3967e+00, -4.4913e-01,\n'
                                               '...            1.6002e+00, -1.6684e-01, -2.0014e+00],\n'
                                               '...          [-7.2120e-01,  1.6054e-02,  2.3266e+00, -5.5836e-01,  5.1569e-01,\n'
                                               '...            2.0147e+00, -1.7014e+00, -5.5972e-01, -8.0995e-02,  5.2522e-01,\n'
                                               '...           -4.2173e-01, -8.6590e-01, -4.0328e-01, -1.0571e+00,  4.8111e-01,\n'
                                               '...            1.3981e+00, -2.6200e-01, -5.3110e-01,  6.7711e-01, -5.9746e-01,\n'
                                               '...            4.5796e-01,  2.6588e-01, -1.1933e-01, -6.5678e-01,  9.0724e-01,\n'
                                               '...           -2.9281e-01,  5.3001e-02,  8.6813e-01],\n'
                                               '...          [-1.0787e+00,  2.0144e-01, -6.6704e-01,  1.8527e-01, -1.1348e+00,\n'
                                               '...           -7.8421e-01,  9.6940e-01, -9.0726e-01, -1.2332e-01,  1.4130e+00,\n'
                                               '...            1.2775e+00, -1.0307e-01, -7.1047e-01,  2.7147e+00,  5.5690e-01,\n'
                                               '...           -4.6458e-01, -2.2390e-01,  8.4848e-03,  1.4980e-01,  8.8144e-01,\n'
                                               '...            5.3864e-01, -5.6449e-01, -2.2648e+00, -4.6675e-01, -7.3203e-01,\n'
                                               '...            1.9242e+00,  1.4344e-01, -7.2431e-02],\n'
                                               '...          [ 2.3702e-02, -6.5644e-01, -1.4327e+00, -7.7982e-01,  1.7250e+00,\n'
                                               '...           -1.4739e+00,  9.6450e-01, -8.6587e-01,  3.3925e-01, -1.2724e+00,\n'
                                               '...            6.3327e-01,  9.9289e-01,  9.1229e-01,  7.0858e-01,  1.8592e-01,\n'
                                               '...            7.4467e-01, -9.8615e-01,  8.3398e-01,  1.0175e+00,  1.0256e+00,\n'
                                               '...            1.9925e+00, -3.4994e-01, -8.4494e-02, -1.8074e+00, -4.4851e-02,\n'
                                               '...           -1.0468e-02, -1.6800e+00, -1.5168e-01],\n'
                                               '...          [ 8.5979e-01,  4.8983e-01, -2.0546e+00, -1.0720e+00,  4.5222e-01,\n'
                                               '...            9.3102e-01,  9.4370e-01,  7.5795e-01,  1.3294e+00,  4.1981e-01,\n'
                                               '...           -3.7976e-01,  9.9331e-02, -9.3615e-01, -6.5467e-01,  1.0958e+00,\n'
                                               '...            1.7523e-01,  8.6485e-01,  1.7600e-01,  2.8704e-01, -2.8505e-01,\n'
                                               '...           -1.5592e+00,  1.4955e+00,  1.3516e+00,  6.1511e-02, -7.6515e-01,\n'
                                               '...            1.7336e+00, -1.1846e+00,  1.3488e-01],\n'
                                               '...          [ 1.3194e+00,  7.4822e-01,  2.6340e-01,  3.9769e-01,  9.7090e-01,\n'
                                               '...           -3.5296e-02,  7.8609e-01,  5.0405e-01,  1.3060e+00,  3.0685e-01,\n'
                                               '...           -9.3623e-02, -1.5846e+00, -4.6414e-01,  1.7783e+00, -2.6349e+00,\n'
                                               '...           -1.2478e-01,  3.0502e-02,  1.8312e+00, -1.6563e+00,  1.1936e+00,\n'
                                               '...            1.1236e-01,  1.4501e+00, -5.2055e-01,  8.1339e-01, -8.2682e-02,\n'
                                               '...            1.1411e+00, -5.9937e-01, -2.2968e-01],\n'
                                               '...          [ 4.0863e-01, -2.8143e-01, -7.0057e-01,  1.1811e+00,  1.2763e-01,\n'
                                               '...            1.0111e+00,  1.2024e+00,  1.4498e+00,  3.7325e-01,  9.0101e-02,\n'
                                               '...            1.2000e+00,  1.5474e+00, -3.4715e-01, -1.4325e+00,  5.7172e-01,\n'
                                               '...            6.3293e-01,  1.6175e-01,  1.9540e+00,  1.3070e-02,  9.5410e-02,\n'
                                               '...            9.5203e-01, -3.7128e-01, -2.1774e-02, -1.0067e+00, -1.0044e+00,\n'
                                               '...            7.7477e-01, -4.9787e-01, -2.0094e+00],\n'
                                               '...          [-2.6010e-01, -3.9013e-01,  3.2456e-01,  2.5319e+00,  1.3314e+00,\n'
                                               '...           -1.2333e+00, -7.3010e-01,  6.2123e-02, -8.5103e-01, -1.7338e+00,\n'
                                               '...            2.4369e-01, -5.5038e-01,  1.3939e+00, -2.2425e+00, -8.0723e-01,\n'
                                               '...            4.5320e-01, -5.2199e-01, -2.8702e-01,  6.5469e-03, -2.0640e-01,\n'
                                               '...           -1.4494e+00,  3.4264e-01,  1.8456e+00, -2.6182e-01,  1.0534e+00,\n'
                                               '...           -1.1459e+00, -1.0469e+00,  8.8438e-01],\n'
                                               '...          [-1.3571e+00,  8.5279e-01,  1.1882e-01, -1.1171e+00,  8.4420e-01,\n'
                                               '...            7.0378e-01, -8.6363e-01, -2.3283e-01,  9.6831e-01,  5.5953e-01,\n'
                                               '...            9.2034e-01, -2.8279e-01, -1.0191e+00, -2.3262e-01,  1.1108e+00,\n'
                                               '...            9.7076e-01,  2.4378e+00, -8.3067e-01, -3.8160e-01, -2.3803e+00,\n'
                                               '...           -7.2196e-01,  1.5755e+00, -2.7272e+00, -3.0634e-01,  1.9787e-02,\n'
                                               '...           -3.7703e-01,  6.3006e-01,  1.0823e+00],\n'
                                               '...          [ 1.0855e+00,  2.6175e-01, -2.0025e+00, -1.6263e+00, -1.0639e+00,\n'
                                               '...            3.5117e-01, -2.6945e-01, -8.2826e-02,  9.0175e-01,  1.0096e+00,\n'
                                               '...           -9.5091e-01,  1.9833e-01, -1.8140e-01,  1.5189e+00,  7.7889e-01,\n'
                                               '...            3.8640e-01,  4.2046e-01, -1.6392e+00, -5.9044e-01, -2.5317e-01,\n'
                                               '...            4.9667e-01,  7.6292e-01, -5.4338e-01, -7.0921e-02, -1.1694e+00,\n'
                                               '...           -4.4924e-02,  1.6847e-01, -4.5950e-01],\n'
                                               '...          [-1.2788e+00,  1.2488e-01,  3.5516e-01,  1.3816e+00,  2.0492e-03,\n'
                                               '...           -1.1195e+00,  2.9844e-01,  2.7702e-01,  3.8599e-01,  1.3904e+00,\n'
                                               '...           -1.1710e+00, -8.9634e-01,  8.7636e-01,  1.7252e+00, -1.0227e+00,\n'
                                               '...           -1.5746e+00, -7.6969e-01, -3.3202e-01,  1.3442e-01, -9.4321e-01,\n'
                                               '...           -6.7248e-01, -6.0521e-01,  9.5220e-01, -8.4992e-01,  1.0038e+00,\n'
                                               '...            5.4091e-01,  9.7905e-01, -2.0862e+00],\n'
                                               '...          [ 5.6856e-01, -2.6157e-02, -2.1585e-01,  2.2127e-01,  1.4718e-01,\n'
                                               '...           -7.2468e-02,  1.1213e+00, -3.1070e-01, -1.4342e-01, -1.3490e+00,\n'
                                               '...            1.7286e+00,  4.1488e-01,  8.9911e-01,  8.6719e-01, -2.5463e-01,\n'
                                               '...           -1.7935e+00,  7.1846e-01,  1.4806e+00, -3.4387e-01,  2.2279e-01,\n'
                                               '...           -3.6421e-01,  5.0627e-01,  5.8819e-01, -2.2068e-01,  8.6131e-02,\n'
                                               '...            1.6661e+00,  2.7719e+00,  3.3583e-01],\n'
                                               '...          [ 2.9832e-01, -1.0200e+00, -1.2714e+00,  1.9833e+00, -7.3869e-01,\n'
                                               '...            6.3494e-01, -6.1603e-01,  9.5195e-01,  9.9361e-02,  1.3271e+00,\n'
                                               '...            1.5830e+00,  2.7952e+00,  1.7784e-02, -6.1032e-01, -8.9067e-01,\n'
                                               '...           -1.7769e+00,  1.4235e-01, -5.0252e-01,  1.3942e+00, -1.0632e+00,\n'
                                               '...            4.3382e-01, -3.7096e-01,  2.1593e+00,  1.4251e+00, -1.1969e+00,\n'
                                               '...           -4.0232e-01,  2.2096e-01, -2.5134e+00],\n'
                                               '...          [-2.8814e+00,  2.9911e-01, -5.5102e-01, -9.9014e-01,  1.4266e+00,\n'
                                               '...           -1.5487e+00, -5.2425e-01,  7.2843e-01, -5.2662e-01, -8.6524e-01,\n'
                                               '...           -3.2109e-01,  6.5959e-01,  1.6242e+00, -2.5876e-01, -5.3911e-03,\n'
                                               '...           -9.3101e-01, -5.0332e-01,  5.8227e-02, -6.3479e-01,  2.2647e-01,\n'
                                               '...           -1.0559e+00,  9.2848e-01, -8.7090e-01, -1.6490e+00, -2.6956e-01,\n'
                                               '...           -8.1313e-01, -7.7660e-01,  3.3153e-01],\n'
                                               '...          [ 8.5333e-01, -2.5853e+00, -5.8621e-01, -2.1205e-01, -7.2525e-01,\n'
                                               '...           -3.3060e-01,  5.4163e-01,  7.7925e-01,  9.6839e-01, -1.3957e+00,\n'
                                               '...           -1.9777e+00, -8.7838e-01, -7.1264e-01, -1.3992e+00, -1.1578e-01,\n'
                                               '...           -2.4481e+00,  5.3878e-01, -3.7956e-01, -4.3145e-01, -2.6452e-01,\n'
                                               '...           -2.1461e+00, -7.8795e-01,  2.7876e-02, -1.0233e+00,  2.0636e-02,\n'
                                               '...            8.4865e-01,  9.4952e-02, -8.3522e-01],\n'
                                               '...          [ 3.3470e-01,  3.3945e+00, -1.4127e+00, -3.6859e-01, -4.9476e-01,\n'
                                               '...           -2.8996e-01, -9.9311e-01,  7.2097e-01,  1.1982e+00,  3.4309e-02,\n'
                                               '...           -9.9755e-01, -1.2083e+00,  6.2757e-01, -1.4975e-01,  1.2563e+00,\n'
                                               '...           -1.9054e-01, -3.8638e-01,  3.0291e-01, -4.8818e-01,  6.3486e-01,\n'
                                               '...            1.9557e-01, -1.2310e+00,  2.3959e-01, -2.2436e-01,  1.5741e-01,\n'
                                               '...           -1.1201e+00,  6.3289e-01,  1.7100e-01],\n'
                                               '...          [-1.8918e-02, -9.7169e-02,  1.6899e-01, -1.3379e+00, -7.5129e-01,\n'
                                               '...            1.0462e+00, -8.2433e-01, -3.3648e-01,  2.7235e+00,  1.9179e+00,\n'
                                               '...            1.4670e-03,  1.0102e+00, -8.9437e-01,  1.1054e+00, -9.5318e-02,\n'
                                               '...           -4.7497e-01, -6.5776e-01, -2.5890e+00,  8.1658e-01, -2.4802e-01,\n'
                                               '...            4.6993e-02,  1.0592e+00, -2.5116e+00,  9.0331e-01, -2.8971e-01,\n'
                                               '...           -7.5401e-01, -1.7507e+00,  3.4983e-01],\n'
                                               '...          [-1.0945e+00,  3.9491e-01,  1.0006e+00,  6.7909e-01, -9.8394e-01,\n'
                                               '...            1.0469e-01,  8.5398e-01,  2.1317e+00, -2.3523e-01,  3.2062e-01,\n'
                                               '...           -9.8410e-02, -3.9521e-02,  6.2222e-01, -4.2842e-01,  1.5926e+00,\n'
                                               '...           -2.7993e-01,  1.3373e+00, -5.2114e-01, -7.8410e-01,  1.8874e-01,\n'
                                               '...            8.5618e-01, -3.5934e-01,  1.7731e+00, -1.0882e+00,  6.7994e-01,\n'
                                               '...           -4.0504e-01, -4.5180e-01,  9.7521e-01],\n'
                                               '...          [ 6.5648e-01,  3.5589e-01, -1.5439e+00, -1.2101e+00,  2.6446e-01,\n'
                                               '...            1.0093e+00,  3.2827e-01, -3.3656e-01,  1.5311e+00,  6.2723e-01,\n'
                                               '...           -7.1368e-01,  1.5889e-02, -3.7618e-01,  2.9210e+00, -1.7533e+00,\n'
                                               '...            2.8333e-01,  3.4569e-01,  1.4796e+00, -1.3036e+00, -1.5646e+00,\n'
                                               '...           -3.5522e-01, -2.4479e-01, -2.1457e-02,  1.7058e-02,  8.1996e-01,\n'
                                               '...            7.4056e-01, -1.1898e+00, -2.2099e+00],\n'
                                               '...          [ 1.6223e+00, -9.7390e-01, -9.4358e-03,  1.8102e-01, -1.9230e+00,\n'
                                               '...            4.2228e-01, -3.2668e-01, -5.8184e-01,  6.0752e-01,  1.5765e+00,\n'
                                               '...           -1.9815e-01, -2.9675e-01,  1.7837e+00, -1.5695e+00,  4.2924e-01,\n'
                                               '...            3.4363e-01, -2.8354e-01,  1.2052e+00,  1.0657e-01,  7.1173e-01,\n'
                                               '...            3.8385e-01,  6.5857e-01,  8.1269e-01, -6.9408e-01,  1.1099e+00,\n'
                                               '...           -3.8112e-01,  6.7776e-01,  1.6048e+00],\n'
                                               '...          [-1.4477e+00, -1.8405e-01, -9.0429e-01, -7.0733e-01,  8.1589e-01,\n'
                                               '...           -1.0153e+00,  6.8890e-01,  1.5438e+00,  1.1306e+00, -9.1640e-01,\n'
                                               '...            1.3988e-01, -2.6187e-01, -2.3922e+00,  4.8428e-01, -1.1322e+00,\n'
                                               '...           -5.4152e-01, -5.8527e-01, -1.3697e-01,  1.1456e+00, -3.1239e-01,\n'
                                               '...            5.9261e-01,  8.1740e-01,  8.2102e-01,  9.4510e-01, -3.9755e-01,\n'
                                               '...            4.2654e-01,  1.3556e-01,  9.9590e-01],\n'
                                               '...          [ 5.2019e-02,  1.8701e-01, -2.7193e-01,  4.3365e-01, -6.4121e-01,\n'
                                               '...           -4.5623e-01, -4.1872e-01, -2.7318e-01, -1.0650e+00,  9.5400e-01,\n'
                                               '...           -5.0803e-01, -2.3303e+00,  1.3525e+00,  6.8950e-01, -7.8147e-01,\n'
                                               '...           -1.0546e+00, -1.2354e+00, -1.3450e+00,  2.5667e-01,  4.9272e-01,\n'
                                               '...            2.2179e+00,  8.3836e-01, -2.5982e-01, -1.8682e-01,  2.5112e+00,\n'
                                               '...           -1.0690e+00,  9.8915e-01, -3.7566e-01],\n'
                                               '...          [ 9.6079e-01, -1.6160e+00, -1.4077e+00, -1.1567e+00,  6.4730e-02,\n'
                                               '...            1.3389e+00, -8.7411e-01, -1.8580e+00,  3.2938e-01, -1.7068e+00,\n'
                                               '...           -9.0635e-01,  2.1441e+00, -9.2262e-01,  3.0341e-01,  1.6684e+00,\n'
                                               '...            9.5033e-03, -5.6993e-01,  1.5754e+00,  1.8496e+00,  3.3461e-01,\n'
                                               '...           -1.4322e-01,  7.5609e-01, -3.6057e-01,  4.8279e-01,  1.7195e-01,\n'
                                               '...            3.7181e-01,  2.5444e-01, -5.0409e-01],\n'
                                               '...          [ 2.3570e-01,  1.5512e+00, -2.0361e-01,  1.3765e+00,  6.4167e-01,\n'
                                               '...           -1.3682e+00,  9.7973e-01,  6.8055e-01,  1.8208e+00,  1.6701e+00,\n'
                                               '...           -1.3007e+00, -2.4307e-02,  2.4393e+00, -6.4590e-01,  5.5267e-01,\n'
                                               '...            7.7356e-01,  1.1357e+00,  2.0037e-01, -6.8700e-03, -3.6883e-01,\n'
                                               '...           -1.6657e-01,  1.1695e-01, -1.1514e+00,  1.6703e-01,  2.3453e-02,\n'
                                               '...            4.7079e-01, -1.4940e+00, -9.4335e-01],\n'
                                               '...          [-1.4217e+00,  1.1319e-01, -1.1987e+00, -1.0707e+00, -1.6156e+00,\n'
                                               '...            1.5311e+00,  6.4375e-01, -5.0993e-01, -1.5645e+00,  5.6811e-01,\n'
                                               '...            5.5249e-01,  1.7943e-02, -1.7798e+00, -8.6444e-01,  7.4597e-03,\n'
                                               '...            1.6779e+00,  3.7317e-01, -1.1464e+00,  4.2141e-01, -7.0107e-01,\n'
                                               '...            1.8853e-01, -7.8087e-01,  1.3583e+00, -4.0573e-01,  1.2955e+00,\n'
                                               '...           -1.8627e+00, -1.3499e+00,  1.0581e+00],\n'
                                               '...          [-7.0509e-02, -1.4871e-01,  2.0478e+00, -1.5107e-02, -5.1870e-01,\n'
                                               '...           -1.2665e-01, -2.5557e-01, -1.1247e+00, -1.2633e+00, -1.1685e+00,\n'
                                               '...           -1.2236e+00, -8.9299e-01, -1.5563e-01, -1.2416e+00,  3.8186e-01,\n'
                                               '...           -1.6785e-01, -2.0881e+00, -1.6852e+00,  6.5980e-01,  5.9026e-01,\n'
                                               '...            1.1913e+00,  1.3226e+00,  7.3143e-02,  6.0152e-02,  7.9603e-01,\n'
                                               '...            8.8768e-01, -2.3259e+00,  5.6589e-01]]]).to(test_device)\n'
                                               '...   ddpm_c_sample_output0, _ = ddpm_c_test.sample(10, (1, 28, 28), device=test_device, guide_w=0.0)\n'
                                               '...   assert torch.allclose(ddpm_c_sample_output0[0], ddpm_c_sample_gt0, rtol=0.001)\n'
                                               '...   ddpm_c_sample_gt0 = torch.tensor([[[-1.5489e-01, -2.2318e+00, -1.0522e+00, -7.1588e-01, -2.7490e-01,\n'
                                               '...            8.7166e-01,  2.5617e-01,  9.1550e-01, -2.0725e-01,  6.6965e-01,\n'
                                               '...            1.0710e+00,  5.8432e-01,  9.3598e-01,  9.3515e-01,  3.5379e-01,\n'
                                               '...            9.4999e-01, -4.9354e-01, -3.8302e-01,  3.4943e-02, -3.0225e-01,\n'
                                               '...            5.5204e-01,  3.7040e-01, -1.8491e+00,  1.1606e+00,  5.3499e-01,\n'
                                               '...            2.8458e-01,  9.8166e-01,  8.0549e-01],\n'
                                               '...          [-1.2827e+00,  1.3396e+00, -2.0422e+00, -1.3219e+00,  7.2995e-02,\n'
                                               '...            1.9940e+00,  1.3308e+00, -3.0168e-01,  4.8397e-01, -1.3643e+00,\n'
                                               '...           -5.7406e-01,  1.6097e-01,  8.9270e-01, -5.1360e-01,  1.4149e+00,\n'
                                               '...            6.6200e-01,  3.7313e-01,  7.1180e-01, -2.5332e-01,  6.9659e-01,\n'
                                               '...           -7.2530e-01,  1.5577e+00,  1.7303e+00, -1.1584e-01,  9.8966e-01,\n'
                                               '...            1.6202e+00,  5.1462e-01,  1.4778e+00],\n'
                                               '...          [ 9.5170e-02, -1.5493e+00, -1.0094e+00, -6.3691e-01,  1.4871e+00,\n'
                                               '...            1.1562e+00, -1.9430e+00,  6.4595e-01,  6.7582e-01,  1.8735e+00,\n'
                                               '...            6.0692e-01, -1.0065e+00, -4.0920e-01,  6.2696e-01, -1.9459e-01,\n'
                                               '...            1.8524e-01,  1.0768e+00, -2.8375e-01,  5.2137e-01, -2.0148e+00,\n'
                                               '...            1.1311e+00,  1.3577e+00,  3.4524e-01, -2.0597e+00, -4.7975e-01,\n'
                                               '...           -5.2316e-01,  8.8341e-01, -1.0139e+00],\n'
                                               '...          [ 1.4889e-01,  3.6955e-01, -2.1123e-01, -2.5375e-01,  1.1283e+00,\n'
                                               '...            1.1987e-01,  4.1716e-01, -4.8257e-01,  7.3450e-02,  1.0963e+00,\n'
                                               '...           -5.4891e-01, -5.3622e-01, -1.3418e+00, -8.5242e-01, -1.9402e+00,\n'
                                               '...           -7.3645e-01, -1.5622e+00, -1.3650e+00, -1.5208e+00,  1.6658e+00,\n'
                                               '...           -1.7522e+00,  1.0159e+00, -9.4279e-02,  2.5711e-01,  5.5629e-01,\n'
                                               '...           -2.9273e-01, -1.7017e-01,  7.7866e-01],\n'
                                               '...          [-1.0721e+00, -1.5733e+00, -3.5271e-01,  1.2531e+00, -6.1215e-01,\n'
                                               '...            1.8442e+00, -2.6515e-01, -1.8522e+00, -2.8782e-01,  5.3608e-01,\n'
                                               '...            1.3323e-01, -1.5175e-01,  9.3550e-01,  1.6892e-01, -3.2988e-01,\n'
                                               '...           -1.3763e+00,  6.3664e-01, -1.5713e+00,  8.2526e-01, -7.6651e-01,\n'
                                               '...           -3.6566e-02, -7.5065e-01,  1.2243e+00, -4.0465e-01,  1.5959e-01,\n'
                                               '...           -1.9261e-01, -1.4865e-01,  1.3305e+00],\n'
                                               '...          [-1.1314e+00, -1.1525e-01,  7.3617e-01,  1.1525e+00, -8.1816e-01,\n'
                                               '...           -1.3250e-01, -1.0965e-01, -6.7093e-02, -5.8235e-01,  3.0615e-01,\n'
                                               '...           -8.1010e-01,  1.0032e+00, -7.1361e-01,  1.7541e+00,  1.1437e+00,\n'
                                               '...           -1.5719e+00,  1.4329e-01,  1.0001e+00,  1.4585e+00,  7.9672e-01,\n'
                                               '...            7.6205e-01,  1.1445e+00,  2.1195e-01, -1.6182e+00,  2.1205e-01,\n'
                                               '...            2.7664e-01, -7.3582e-01,  5.6675e-01],\n'
                                               '...          [-3.0292e-01, -1.6025e+00,  8.7712e-03,  2.1288e-01, -1.2928e-01,\n'
                                               '...           -1.9202e-01,  6.9701e-01, -5.2284e-01,  2.1488e+00, -7.2446e-01,\n'
                                               '...           -2.6627e+00,  1.3283e+00, -6.0695e-01, -3.7598e-01,  3.9033e-01,\n'
                                               '...            1.4140e+00,  8.0525e-01, -8.9740e-01,  1.3848e+00,  1.5482e-01,\n'
                                               '...           -8.3143e-02,  2.6612e-02, -2.4905e+00,  7.8121e-01, -9.2156e-01,\n'
                                               '...            4.1128e-02, -2.0657e+00, -7.7235e-01],\n'
                                               '...          [-9.9811e-01, -4.0563e-01,  1.8908e-01,  5.8438e-01, -2.1667e+00,\n'
                                               '...            9.8499e-01, -3.9138e-01, -1.3588e+00,  1.2939e-01,  1.6118e+00,\n'
                                               '...           -8.8126e-02,  1.2766e+00, -1.6818e+00, -3.6444e-01, -1.2208e-01,\n'
                                               '...            1.1180e+00, -4.9614e-01, -2.3692e+00, -1.6302e+00,  2.0508e-01,\n'
                                               '...            2.4112e-01,  6.1208e-01, -1.7617e-01,  5.3535e-01,  4.7124e-01,\n'
                                               '...           -1.9390e-01,  9.6494e-01,  1.2970e+00],\n'
                                               '...          [ 1.0432e+00, -1.0334e+00,  2.3368e-01, -4.4107e-01,  2.0236e-01,\n'
                                               '...           -7.4791e-01, -4.9031e-01,  1.7026e+00,  1.9987e-01, -8.9823e-01,\n'
                                               '...            6.1720e-01,  8.3462e-01,  1.4173e+00, -9.8172e-01,  7.9573e-01,\n'
                                               '...           -1.2846e+00, -7.2367e-01,  2.3586e+00,  1.3275e+00, -1.3637e+00,\n'
                                               '...            1.0945e+00, -1.2136e+00, -2.0053e-02, -3.3498e-01, -1.0945e+00,\n'
                                               '...            9.6409e-01,  4.9679e-02,  1.6103e+00],\n'
                                               '...          [ 1.4114e+00, -1.1907e-01, -6.7837e-01, -2.9349e-01, -2.0210e+00,\n'
                                               '...           -7.1699e-01,  2.3408e+00,  1.6870e-01,  1.1732e+00, -4.6916e-01,\n'
                                               '...           -1.5461e+00, -8.8774e-02, -5.6270e-01, -2.4087e+00,  1.1476e+00,\n'
                                               '...           -1.2644e+00, -1.0506e+00, -2.5457e+00, -5.6373e-01, -1.1287e+00,\n'
                                               '...           -1.4642e-01,  1.0522e+00,  4.1159e-01, -1.2311e+00, -2.7352e-01,\n'
                                               '...           -1.4313e+00,  3.4990e-01,  1.4207e+00],\n'
                                               '...          [ 1.0611e+00,  4.2984e-01,  1.3839e+00,  5.5790e-01, -1.2891e+00,\n'
                                               '...            1.5604e+00,  5.3109e-01, -1.2466e+00,  1.2722e+00, -1.1400e+00,\n'
                                               '...            6.6475e-01,  6.9308e-01, -2.4641e-01,  1.8641e+00, -1.4742e+00,\n'
                                               '...            1.8969e-01,  1.0423e+00,  9.1723e-01, -5.7426e-01, -8.5808e-01,\n'
                                               '...           -1.5975e+00, -3.0308e-01,  1.7392e+00, -4.4909e-02,  9.7099e-02,\n'
                                               '...            8.6246e-02, -9.4602e-01, -2.7301e+00],\n'
                                               '...          [ 1.7622e-01, -9.5670e-01,  7.2468e-01, -2.1704e-01, -8.3117e-01,\n'
                                               '...            4.4125e-01, -2.5351e-02, -2.3728e+00, -1.3567e+00, -1.0850e+00,\n'
                                               '...            8.2075e-01,  6.9733e-01,  2.4279e-01,  6.7661e-01,  1.1148e+00,\n'
                                               '...           -4.7274e-01, -8.7600e-01, -7.6676e-01,  8.1152e-01, -5.9073e-01,\n'
                                               '...            1.9263e-01,  6.4622e-01,  1.7279e-02,  5.6162e-01, -1.2472e+00,\n'
                                               '...           -7.1446e-01, -1.3658e+00, -2.5169e-01],\n'
                                               '...          [-5.9614e-01,  1.5974e+00, -2.8752e-02, -1.4302e+00, -7.7173e-02,\n'
                                               '...            6.2244e-01, -7.1650e-01, -4.1039e-01, -1.0511e+00, -2.2352e-01,\n'
                                               '...            2.4103e+00, -1.2486e-01,  6.5442e-02,  1.2435e-01, -9.3734e-01,\n'
                                               '...            6.9386e-01,  1.7024e+00, -7.1600e-02, -8.5866e-01, -1.8090e-01,\n'
                                               '...           -1.8271e-01,  1.9255e-01, -8.3138e-01,  1.4952e+00, -1.5949e+00,\n'
                                               '...            1.7299e-01, -1.0804e+00,  4.6307e-01],\n'
                                               '...          [-1.6198e+00,  1.2958e+00, -2.1757e+00,  7.6314e-01,  6.1339e-02,\n'
                                               '...           -8.2582e-01,  6.6288e-01, -5.0628e-01, -4.0615e-01,  2.0866e+00,\n'
                                               '...            4.9213e-01, -1.1087e-01,  3.3595e-01, -1.5865e+00,  5.3465e-01,\n'
                                               '...           -4.2798e-01, -1.5721e+00, -8.5863e-01,  5.4523e-01, -7.0212e-01,\n'
                                               '...            4.9196e-01, -1.4496e+00, -5.6779e-01,  1.4870e+00,  1.2799e+00,\n'
                                               '...           -3.2454e-01, -2.0261e+00,  2.2497e-01],\n'
                                               '...          [ 1.7460e+00,  1.4446e+00,  1.6572e+00, -8.6675e-01,  9.8528e-02,\n'
                                               '...           -1.0668e+00, -5.5897e-01, -6.8629e-01,  2.2598e-01, -4.6755e-01,\n'
                                               '...           -3.6747e-01,  1.6336e+00,  3.8494e-01,  2.5222e-01, -1.4179e+00,\n'
                                               '...            6.4078e-01, -2.5849e-02, -6.7350e-01,  1.0547e-01, -8.8534e-01,\n'
                                               '...            2.3517e-01, -1.6441e+00,  1.4080e+00,  1.6292e+00, -1.1994e+00,\n'
                                               '...           -2.8764e-01,  1.8768e+00, -1.0573e+00],\n'
                                               '...          [-4.5877e-02,  1.8785e-01,  5.6993e-01,  9.7634e-01,  6.1984e-01,\n'
                                               '...            1.9537e+00,  1.2098e+00,  1.2366e+00, -1.3950e+00,  3.6999e-01,\n'
                                               '...           -6.6114e-01,  1.0554e+00, -2.0041e-01, -8.2693e-02,  6.0858e-01,\n'
                                               '...            3.1139e-01,  4.9172e-01,  2.1887e+00,  7.1979e-01, -8.1799e-01,\n'
                                               '...            5.2135e-01, -1.6831e-01, -1.1605e+00, -3.2909e-01, -1.4516e+00,\n'
                                               '...           -9.9516e-01, -1.3204e+00,  6.3080e-02],\n'
                                               '...          [ 8.6890e-01, -6.2082e-01, -1.9100e+00, -8.8931e-01,  1.3363e+00,\n'
                                               '...            4.1026e-01, -1.5081e+00, -1.5134e+00,  8.8133e-01,  1.6671e+00,\n'
                                               '...           -7.8160e-01,  7.8877e-02, -2.9842e-01,  1.4867e+00, -5.4766e-01,\n'
                                               '...           -1.1723e+00, -9.8150e-01, -1.1556e+00, -1.1177e+00,  1.5837e-01,\n'
                                               '...           -4.4771e-01,  3.5460e-01,  6.1738e-01, -1.4702e+00,  1.4696e+00,\n'
                                               '...           -4.7770e-01,  4.4606e-02,  4.7878e-03],\n'
                                               '...          [ 1.6532e+00,  1.6727e+00,  3.7575e-01, -1.8667e-01, -1.0958e-01,\n'
                                               '...           -2.6459e-01, -1.3087e+00,  2.1344e-01,  3.3948e-02, -1.0168e+00,\n'
                                               '...            1.1674e+00,  2.3925e-01, -1.9301e+00, -7.4565e-01,  7.1341e-01,\n'
                                               '...            1.1720e+00,  1.3338e+00,  1.7713e-01,  5.9020e-02, -9.3879e-02,\n'
                                               '...           -5.3797e-01, -5.7611e-01, -4.0683e-02, -1.2803e+00,  3.4174e-01,\n'
                                               '...            1.2439e+00,  4.6430e-01, -5.9217e-01],\n'
                                               '...          [-1.0487e-01, -1.9519e+00, -2.5820e+00,  4.2326e-01, -8.3077e-01,\n'
                                               '...            6.0467e-01, -8.9191e-01, -7.0717e-01,  2.1403e+00, -9.2095e-01,\n'
                                               '...           -4.1353e-01, -9.7259e-01, -9.7834e-01,  1.2300e+00,  2.4261e+00,\n'
                                               '...            7.8189e-01,  3.2471e-01,  2.0109e+00,  1.3321e+00,  7.1574e-01,\n'
                                               '...            1.8162e+00, -4.5474e-01, -3.1469e-01, -2.5685e+00,  2.0312e-01,\n'
                                               '...           -1.3424e-01,  2.4223e-01,  5.2198e-01],\n'
                                               '...          [ 1.1128e+00,  5.1492e-01,  3.4735e-01,  1.2973e+00,  2.9256e-01,\n'
                                               '...           -1.8791e+00, -3.5218e-01, -1.3117e-01, -4.9796e-02,  3.9263e-01,\n'
                                               '...            4.2392e-01, -1.8013e+00,  2.5269e-01,  2.8486e-01, -1.0935e+00,\n'
                                               '...            5.6803e-01,  4.2486e-01,  1.0316e+00,  6.9342e-01,  4.1405e-01,\n'
                                               '...           -1.4616e+00, -5.5781e-01, -9.3736e-01,  1.6951e+00,  1.0128e+00,\n'
                                               '...            2.6037e-01,  6.4577e-01,  1.6577e+00],\n'
                                               '...          [ 9.5208e-01,  1.5782e+00,  1.9618e-01,  1.4099e+00, -2.1220e+00,\n'
                                               '...           -4.2439e-01, -3.1876e-01, -7.7152e-01,  8.6842e-01, -1.5794e+00,\n'
                                               '...            9.6525e-01, -2.2928e+00, -1.0730e+00,  5.6980e-01, -9.2277e-01,\n'
                                               '...           -1.5721e-01, -1.4534e+00, -6.2899e-01, -1.4669e+00,  2.9562e-01,\n'
                                               '...            1.1427e-01,  1.5516e-01,  3.4762e-01,  3.2195e-01,  3.7966e-01,\n'
                                               '...           -2.9484e-01, -1.6054e+00, -8.1295e-01],\n'
                                               '...          [ 3.9556e-02,  7.6139e-01,  7.0178e-01,  4.8300e-01,  9.7096e-02,\n'
                                               '...            2.9014e+00,  9.5674e-01, -7.5689e-01,  3.4144e-01, -5.9221e-01,\n'
                                               '...            1.3446e+00,  3.3075e-01, -6.0529e-01,  8.9784e-01,  5.0865e-02,\n'
                                               '...           -5.2753e-01,  5.7508e-01, -2.3966e+00, -3.9079e-01,  5.1982e-01,\n'
                                               '...           -6.6716e-01,  1.9149e+00,  6.8246e-01, -4.9116e-01,  2.6799e-01,\n'
                                               '...           -3.3806e-01, -2.7492e-01, -3.7903e-01],\n'
                                               '...          [-9.9629e-01, -6.2978e-01,  5.5303e-01,  1.1820e+00,  5.4881e-02,\n'
                                               '...            4.5835e-01,  1.8760e-02, -3.5020e-01,  8.1149e-02,  1.2048e+00,\n'
                                               '...           -1.6008e+00,  1.9177e+00, -7.3923e-02, -1.8590e-01,  4.2825e-01,\n'
                                               '...            7.3142e-02,  5.3012e-01, -1.6273e+00,  1.2316e+00,  8.4649e-01,\n'
                                               '...           -8.4704e-02,  8.0613e-01, -5.8855e-01, -7.6652e-01,  1.5556e+00,\n'
                                               '...            1.2903e+00,  1.5743e+00,  1.8518e-01],\n'
                                               '...          [ 1.1092e+00,  4.7202e-01, -4.4268e-01,  2.4300e-01,  9.1774e-01,\n'
                                               '...           -1.4023e+00,  1.1063e+00, -9.6646e-01,  1.1655e+00, -6.9771e-01,\n'
                                               '...           -8.0934e-02,  4.4286e-01, -6.6057e-01,  1.2930e+00, -5.4027e-01,\n'
                                               '...           -1.4980e+00,  1.0908e+00, -3.6006e-01,  4.6395e-01,  1.4547e+00,\n'
                                               '...           -3.6220e-01,  2.0199e+00,  3.5178e-01,  1.1726e+00, -1.6616e+00,\n'
                                               '...            1.3957e-01,  1.3791e+00,  1.0099e-01],\n'
                                               '...          [ 1.0372e+00, -1.9521e+00,  3.0017e-02,  7.6229e-01,  7.1029e-02,\n'
                                               '...           -3.3641e-01,  1.4560e+00,  1.5970e+00,  3.4995e-02, -7.6774e-01,\n'
                                               '...           -1.1988e-03, -1.2721e-01, -6.9420e-01,  6.9548e-01, -6.8332e-01,\n'
                                               '...            1.8875e+00, -3.5526e-01,  6.4520e-01, -2.1658e+00,  2.5786e-01,\n'
                                               '...            5.2892e-02,  6.6390e-01,  7.2646e-01,  1.7442e+00,  1.9514e-01,\n'
                                               '...           -1.6573e-01,  1.7559e-01,  1.9788e+00],\n'
                                               '...          [ 6.1007e-01, -4.5231e-02, -1.6501e+00, -2.5792e-01, -5.2561e-01,\n'
                                               '...           -1.9212e+00, -1.0478e+00,  5.5424e-02,  2.0313e+00, -1.3595e+00,\n'
                                               '...            2.1880e+00,  8.0535e-01,  1.5600e+00,  8.6114e-01, -1.0479e+00,\n'
                                               '...            4.9396e-01, -1.0509e+00, -8.8911e-01,  1.8498e-01,  2.2418e-01,\n'
                                               '...           -1.8598e-01,  3.4246e-01, -3.0417e-01,  3.6986e-01,  3.3479e-01,\n'
                                               '...            6.6906e-01, -1.9556e+00, -6.9822e-01],\n'
                                               '...          [-9.7212e-01, -1.1477e+00,  8.6399e-01,  1.2011e+00,  2.7287e-01,\n'
                                               '...            1.0228e+00,  1.3585e-01, -7.9800e-01, -7.8898e-02, -1.7514e+00,\n'
                                               '...           -5.1832e-01, -2.6070e-01, -8.5609e-01, -1.3831e+00, -4.4267e-01,\n'
                                               '...           -3.9584e-01,  7.3720e-01, -1.1889e+00, -1.3207e+00, -2.2575e+00,\n'
                                               '...            4.5236e-01,  1.0992e+00,  4.8995e-01,  4.0870e-02, -9.4583e-01,\n'
                                               '...           -5.1126e-01, -3.0744e-01, -3.2543e+00],\n'
                                               '...          [ 1.8975e+00, -9.5019e-01,  5.1476e-01, -5.5371e-01, -6.2721e-01,\n'
                                               '...           -7.8961e-01,  8.5023e-01,  1.1056e+00,  8.5419e-02,  9.6024e-01,\n'
                                               '...           -5.1720e-01, -1.6326e-01, -8.9202e-01, -3.7929e-01,  1.7154e+00,\n'
                                               '...           -1.1766e-01,  1.2717e+00, -9.5712e-02, -3.6355e-01,  1.3094e+00,\n'
                                               '...           -1.6318e+00,  1.0652e+00, -1.3303e+00, -1.1893e+00,  1.7231e+00,\n'
                                               '...           -1.0224e+00, -2.6620e-01,  6.4192e-01]]]).to(test_device)\n'
                                               '...   ddpm_c_sample_output0, _ = ddpm_c_test.sample(10, (1, 28, 28), device=test_device, guide_w=0.1)\n'
                                               '...   assert torch.allclose(ddpm_c_sample_output0[0], ddpm_c_sample_gt0, rtol=0.001)\n'
                                               '>>> test_ddpm_conditional()\n',
                                       'hidden': False,
                                       'locked': False}],
                      'scored': True,
                      'setup': '',
                      'teardown': '',
                      'type': 'doctest'}]}
